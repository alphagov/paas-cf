<% plans = [
	# Redis 3.2
	{
		"name" => "tiny-clustered-3.2",
		"valid_from" => "2017-01-01",
		"guid" => "3a51701c-eef3-447c-882b-907ad2bcb7ab",
		"ha" => false,
		"aws_price" => price("elasticache_t2_micro")
	},
	{
    "name" => "tiny-3.2",
    "valid_from" => "2017-01-01",
    "guid" => "c84d1bef-9500-4ce9-88b2-c0bd421bbf8a",
    "ha" => false,
    "aws_price" => price("elasticache_t2_micro")
  },
  {
    "name" => "tiny-ha-3.2",
    "valid_from" => "2019-08-01",
    "guid" => "ea5c8cc3-74e6-4b15-bd61-bbe244cfe63d",
    "ha" => true,
    "aws_price" => price("elasticache_t2_small")
  },
  {
    "name" => "small-ha-3.2",
    "valid_from" => "2019-08-01",
    "guid" => "9162ed5b-0c88-4f43-bcaf-c6d4a45dd243",
    "ha" => true,
    "aws_price" => price("elasticache_t2_medium")
  },
  {
    "name" => "medium-ha-3.2",
    "valid_from" => "2019-08-01",
    "guid" => "b6949ea7-5c98-4c69-b981-4b5318ea8b7c",
    "ha" => true,
    "aws_price" => price("elasticache_m5_large")
  },

	# Redis 4.x
	{
	  "name" => "tiny-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "b78c9d07-a031-495f-937c-28613905431c",
	  "ha" => false,
	  "aws_price" => price("elasticache_t2_small")
	},
	{
	  "name" => "tiny-ha-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "e31d1a05-4f75-4bca-93a0-661bc233d25c",
	  "ha" => true,
	  "aws_price" => price("elasticache_t2_small")
	},
	{
	  "name" => "small-ha-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "09e7088e-125e-4805-9eff-02bf61ee0146",
	  "ha" => true,
	  "aws_price" => price("elasticache_t2_medium")
	},
	{
	  "name" => "medium-ha-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "f210be07-8ea3-4295-a929-2dec0ae4cd30",
	  "ha" => true,
	  "aws_price" => price("elasticache_m5_large")
	},
  {
	  "name" => "large-ha-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "4b5913cd-c39b-457c-8f77-eb9a95d63ba8",
	  "ha" => true,
	  "aws_price" => price("elasticache_m5_xlarge")
	},
  {
	  "name" => "xlarge-ha-4.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "e6e8e4c4-5f2e-4add-89d6-ce417f145c19",
	  "ha" => true,
	  "aws_price" => price("elasticache_m5_2xlarge")
	},

	# Redis 5.x
	{
	  "name" => "tiny-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "1f2cccd7-d9a9-4b9a-b517-73b381848b73",
	  "ha" => false,
	  "aws_price" => price("elasticache_t2_small")
	},
	{
	  "name" => "tiny-ha-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "c12a6a40-fb53-4e1e-b0a9-ba5e3180e3b7",
	  "ha" => true,
	  "aws_price" => price("elasticache_t2_small")
	},
	{
	  "name" => "small-ha-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "07479e46-0169-4395-91d8-e125efb17e2c",
	  "ha" => true,
		"aws_price" => price("elasticache_t2_medium")
	},
	{
	  "name" => "medium-ha-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "a5ee300e-9c75-45f3-939b-d74ca4c178e7",
	  "ha" => true,
    "aws_price" => price("elasticache_m5_large")
	},
  {
	  "name" => "large-ha-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "883c0549-cacd-4d73-adf8-85096a3c39a4",
	  "ha" => true,
    "aws_price" => price("elasticache_m5_xlarge")
	},
  {
	  "name" => "xlarge-ha-5.x",
	  "valid_from" => "2020-03-01",
	  "guid" => "f60443d9-3e9f-4c9b-8653-c83b6418292e",
	  "ha" => true,
    "aws_price" => price("elasticache_m5_2xlarge")
	}

] %>

<% for @plan in plans %>
	{
		"name": "redis <%= @plan["name"] %>",
		"valid_from": "<%= @plan["valid_from"] %>",
		"plan_guid": "<%= @plan["guid"] %>",
		"number_of_nodes": <%= if @plan["ha"] then 2 else 1 end%>,
		"components": [
			{
				"name": "instance",
				"formula": "$number_of_nodes * ceil($time_in_seconds/3600) * <%= @plan["aws_price"] %>",
				"currency_code": "USD",
				"vat_code": "Standard"
			}
		]
	},
<% end %>
